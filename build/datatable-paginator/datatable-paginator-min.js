YUI.add("datatable-paginator",function(o,g){var t,e,l=o.DataTable.Templates.Paginator,a=o.Lang.sub,h=o.ClassNameManager.getClassName,n=h(g,"control-disabled"),i="paginator:ui";function s(){}t=o.Base.create("dt-pg-model",o.Model,[o.Paginator.Core]),e=o.Base.create("dt-pg-view",o.View,[],{_eventHandles:[],containerTemplate:'<div class="{paginator}"/>',contentTemplate:"{buttons}{goto}{perPage}",_allowAdHocAttrs:!1,initializer:function(){this.containerTemplate=a(this.containerTemplate,{paginator:h(g)}),this._initStrings(),this._initClassNames(),this.attachEvents()},render:function(){var t=this.get("model"),e=a(this.contentTemplate,{buttons:this._buildButtonsGroup(),"goto":this._buildGotoGroup(),perPage:this._buildPerPageGroup()});return this.get("container").append(e),this.attachEvents(),this._rendered=!0,this._updateControlsUI(t.get("page")),this._updateItemsPerPageUI(t.get("itemsPerPage")),this},attachEvents:function(){e.superclass.attachEvents.apply(this,arguments);var t=this.get("container");this.classNames||this._initClassNames(),this._attachedViewEvents.push(t.delegate("click",this._controlClick,"."+this.classNames.control,this),this.get("model").after("change",this._modelChange,this)),t.all("form").each(o.bind(function(t){this._attachedViewEvents.push(t.after("submit",this._controlSubmit,this))},this)),t.all("select").each(o.bind(function(t){this._attachedViewEvents.push(t.after("change",this._controlChange,this))},this))},_buildButtonsGroup:function(){var t=this.get("strings"),e=this.classNames,t=l.button({type:"first",label:t.first,classNames:e})+l.button({type:"prev",label:t.prev,classNames:e})+l.button({type:"next",label:t.next,classNames:e})+l.button({type:"last",label:t.last,classNames:e});return l.buttons({classNames:e,buttons:t})},_buildGotoGroup:function(){return l.gotoPage({classNames:this.classNames,strings:this.get("strings"),page:this.get("model").get("page")})},_buildPerPageGroup:function(){for(var t,e=this.get("pageSizes"),a=this.get("model").get("rowsPerPage"),i=0,s=e.length;i<s;i++)(t="object"!=typeof(t=e[i])?{value:t,label:t}:t).selected=t.value===a?" selected":"";return l.perPage({classNames:this.classNames,strings:this.get("strings"),options:this.get("pageSizes")})},_modelChange:function(t){var e=t.changed,a=e&&e.page,e=e&&e.itemsPerPage;a&&this._updateControlsUI(a.newVal),e&&(this._updateItemsPerPageUI(e.newVal),a||this._updateControlsUI(t.target.get("page")))},_updateControlsUI:function(t){var e,a,i,s;this._rendered&&(s=this.get("model"),e="."+this.classNames.control,a=this.get("container"),i=s.hasPrevPage(),s=s.hasNextPage(),a.one(e+"-first").toggleClass(n,!i).set("disabled",!i),a.one(e+"-prev").toggleClass(n,!i).set("disabled",!i),a.one(e+"-next").toggleClass(n,!s).set("disabled",!s),a.one(e+"-last").toggleClass(n,!s).set("disabled",!s),a.one("form input").set("value",t))},_updateItemsPerPageUI:function(t){this._rendered&&this.get("container").one("select").set("value",t)},_controlClick:function(t){t.preventDefault();t=t.currentTarget;t.hasClass(n)||this.fire(i,{type:t.getData("type"),val:t.getData("page")||null})},_controlChange:function(t){t.target.hasClass(n)||(val=t.target.get("value"),this.fire(i,{type:"perPage",val:parseInt(val,10)}))},_controlSubmit:function(t){t.target.hasClass(n)||(t.preventDefault(),input=t.target.one("input"),this.fire(i,{type:"page",val:+input.get("value")}))},_initClassNames:function(){this.classNames={control:h(g,"control"),controls:h(g,"controls"),group:h(g,"group"),perPage:h(g,"per-page")}},_initStrings:function(){this.set("strings",o.mix(this.get("strings")||{},o.Intl.get("datatable-paginator")))},_defPageSizeVal:function(){return this._initStrings(),[10,50,100,{label:this.get("strings").showAll,value:-1}]}},{ATTRS:{pageSizes:{valueFn:"_defPageSizeVal"},model:{}}}),s.ATTRS={paginatorModel:{setter:"_setPaginatorModel",value:null,writeOnce:"initOnly"},paginatorModelType:{getter:"_getConstructor",value:"DataTable.Paginator.Model",writeOnce:"initOnly"},paginatorView:{getter:"_getConstructor",value:"DataTable.Paginator.View",writeOnce:"initOnly"},pageSizes:{setter:"_setPageSizesFn",valueFn:"_defPageSizeVal"},paginatorStrings:{},rowsPerPage:{value:null},paginatorLocation:{value:"footer"}},o.mix(s.prototype,{firstPage:function(){return this.get("paginatorModel").set("page",1),this},lastPage:function(){var t=this.get("paginatorModel");return t.set("page",t.get("totalPages")),this},previousPage:function(){return this.get("paginatorModel").prevPage(),this},nextPage:function(){return this.get("paginatorModel").nextPage(),this},initializer:function(){this._initPaginatorStrings(),this._augmentData(),this._eventHandles.paginatorRender||(this._eventHandles.paginatorRender=o.Do.after(this._paginatorRender,this,"render"))},_paginatorRender:function(){var t=this.get("paginatorModel");this._paginatorRenderUI(),t.after("change",this._afterPaginatorModelChange,this),this.after("dataChange",this._afterDataChangeWithPaginator,this),this.after("rowsPerPageChange",this._afterRowsPerPageChange,this),this.data.after(["add","remove","change"],this._afterDataUpdatesWithPaginator,this),t.set("itemsPerPage",this.get("rowsPerPage")),t.set("totalItems",this.get("data").size())},_afterDataChangeWithPaginator:function(){var t=this.get("data"),e=this.get("paginatorModel");e.set("totalItems",t.size()),1!==e.get("page")?this.firstPage():(this._augmentData(),t.fire.call(t,"reset",{src:"reset",models:t._items.concat()}))},_afterDataUpdatesWithPaginator:function(){var t=this.get("paginatorModel"),e=this.get("data");t.set("totalItems",e.size())},_afterRowsPerPageChange:function(t){var e,a=this.get("data"),i=this.get("paginatorModel");if(null!==t.newVal)this._paginatorRenderUI(),a._paged||this._augmentData(),a._paged.index=(i.get("page")-1)*i.get("itemsPerPage"),a._paged.length=i.get("itemsPerPage");else{for(;this._pgViews.length;)(e=this._pgViews.shift()).destroy({remove:!0}),e._rendered=null;a._paged.index=0,a._paged.length=null}this.get("paginatorModel").set(
"itemsPerPage",parseInt(t.newVal,10))},_paginatorRenderUI:function(){var s,n,r,t;this.get("rowsPerPage")&&(s=this._pgViews,n=this.get("paginatorView"),r={pageSizes:this.get("pageSizes"),model:this.get("paginatorModel")},t=this.get("paginatorLocation"),o.Lang.isArray(t)||(t=[t]),s=s||(this._pgViews=[]),o.Array.each(t,function(t){var e,a=new n(r),i=a.render().get("container");a.after("*:ui",this._uiPgHandler,this),s.push(a),t._node?(t.append(i),this.after("destroy",function(){a.destroy({remove:!0})})):"footer"===t?(this.foot||(this.foot=new o.DataTable.FooterView({host:this}),this.foot.render(),this.fire("renderFooter",{view:this.foot})),(e=o.Node.create(l.rowWrapper({wrapperClass:h(g,"wrapper"),numOfCols:this.get("columns").length}))).one("td").append(i),this.foot.tfootNode.append(e),a.after("destroy",function(){e.remove(!0)})):"header"===t&&(this.view&&this.view.tableNode?this.view.tableNode.insert(i,"before"):this.get("contentBox").prepend(i))},this))},_uiPgHandler:function(t){var e=this.get("paginatorModel");switch(t.type){case"first":e.set("page",1);break;case"last":e.set("page",e.get("totalPages"));break;case"prev":case"next":e[t.type+"Page"]();break;case"page":e.set("page",t.val);break;case"perPage":e.set("itemsPerPage",t.val),e.set("page",1)}},_afterPaginatorModelChange:function(){var t=this.get("paginatorModel"),e=this.get("data");e._paged?(e._paged.index=(t.get("page")-1)*t.get("itemsPerPage"),e._paged.length=t.get("itemsPerPage")):this._augmentData(),e.fire.call(e,"reset",{src:"reset",models:e._items.concat()})},_augmentData:function(){var t=this.get("paginatorModel");null!==this.get("rowsPerPage")&&o.mix(this.get("data"),{_paged:{index:(t.get("page")-1)*t.get("itemsPerPage"),length:t.get("itemsPerPage")},getPage:function(){var t=this._paged,e=t.index;return 0<=t.length?this._items.slice(e,e+t.length):this._items.slice(e)},size:function(t){return(t&&0<=this._paged.length?this._paged:this._items).length},each:function(){var t=Array.prototype.slice.call(arguments);return t.unshift(this.getPage()),o.Array.each.apply(null,t),this}},!0)},_setPageSizesFn:function(t){var e,a,i,s=t.length;for(o.Lang.isArray(t)||(s=(t=[t]).length),e=0;e<s;e++)"object"!=typeof t[e]&&(a=t[e],i=t[e],parseInt(i,10)!=i&&(i=-1),t[e]={label:a,value:i});return t},_setPaginatorModel:function(t){return t=!t||!t._isYUIModel?new(this.get("paginatorModelType"))(t):t},_getConstructor:function(t){return"string"==typeof t?o.Object.getValue(o,t.split(".")):t},_initPaginatorStrings:function(){this.set("paginatorStrings",o.mix(this.get("paginatorStrings")||{},o.Intl.get("datatable-paginator")))},_defPageSizeVal:function(){return this._initPaginatorStrings(),[10,50,100,{label:this.get("paginatorStrings").showAll,value:-1}]}},!0),o.DataTable.Paginator=s,o.DataTable.Paginator.Model=t,o.DataTable.Paginator.View=e,o.Base.mix(o.DataTable,[o.DataTable.Paginator])},"@VERSION@",{requires:["model","view","paginator-core","datatable-foot","datatable-paginator-templates"],lang:["en","fr"],skinnable:!0});