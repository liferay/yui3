YUI.add("console-filters",function(i,e){var o=i.ClassNameManager.getClassName,a="console",t="filters",c="filter",h="category",l="source",u="category.",f="source.",g="host",_="checked",C="defaultVisibility",d="."+i.Console.CHROME_CLASSES.console_bd_class,s="."+i.Console.CHROME_CLASSES.console_ft_class,r=i.Lang.isString;function n(){n.superclass.constructor.apply(this,arguments)}i.namespace("Plugin").ConsoleFilters=i.extend(n,i.Plugin.Base,{_entries:null,_cacheLimit:Number.POSITIVE_INFINITY,_categories:null,_sources:null,initializer:function(){this._entries=[],this.get(g).on("entry",this._onEntry,this),this.doAfter("renderUI",this.renderUI),this.doAfter("syncUI",this.syncUI),this.doAfter("bindUI",this.bindUI),this.doAfter("clearConsole",this._afterClearConsole),this.get(g).get("rendered")&&(this.renderUI(),this.syncUI(),this.bindUI()),this.after("cacheLimitChange",this._afterCacheLimitChange)},destructor:function(){this._entries=[],this._categories&&this._categories.remove(),this._sources&&this._sources.remove()},renderUI:function(){var e,t=this.get(g).get("contentBox").one(s);t&&(e=i.Lang.sub(n.CATEGORIES_TEMPLATE,n.CHROME_CLASSES),this._categories=t.appendChild(i.Node.create(e)),e=i.Lang.sub(n.SOURCES_TEMPLATE,n.CHROME_CLASSES),this._sources=t.appendChild(i.Node.create(e)))},bindUI:function(){this._categories.on("click",i.bind(this._onCategoryCheckboxClick,this)),this._sources.on("click",i.bind(this._onSourceCheckboxClick,this)),this.after("categoryChange",this._afterCategoryChange),this.after("sourceChange",this._afterSourceChange)},syncUI:function(){i.each(this.get(h),function(e,t){this._uiSetCheckbox(h,t,e)},this),i.each(this.get(l),function(e,t){this._uiSetCheckbox(l,t,e)},this),this.refreshConsole()},_onEntry:function(e){this._entries.push(e.message);var t,i=u+e.message.category,s=f+e.message.source,r=this.get(i),n=this.get(s),o=this._entries.length-this._cacheLimit;0<o&&this._entries.splice(0,o),r===undefined&&(t=this.get(C),this.set(i,t),r=t),n===undefined&&(t=this.get(C),this.set(s,t),n=t),r&&n||e.preventDefault()},_afterClearConsole:function(){this._entries=[]},_afterCategoryChange:function(e){var t=e.subAttrName.replace(/category\./,""),i=e.prevVal,s=e.newVal;t&&i[t]===undefined||(this.refreshConsole(),this._filterBuffer()),t&&!e.fromUI&&this._uiSetCheckbox(h,t,s[t])},_afterSourceChange:function(e){var t=e.subAttrName.replace(/source\./,""),i=e.prevVal,s=e.newVal;t&&i[t]===undefined||(this.refreshConsole(),this._filterBuffer()),t&&!e.fromUI&&this._uiSetCheckbox(l,t,s[t])},_filterBuffer:function(){for(var e=this.get(h),t=this.get(l),i=this.get(g).buffer,s=null,r=i.length-1;0<=r;--r)e[i[r].category]&&t[i[r].source]?s&&(i.splice(r,s-r),s=null):s=s||r;s&&i.splice(0,s+1)},_afterCacheLimitChange:function(e){!isFinite(e.newVal)||0<(e=this._entries.length-e.newVal)&&this._entries.splice(0,e)},refreshConsole:function(){var e,t,i=this._entries,s=this.get(g),r=s.get("contentBox").one(d),n=s.get("consoleLimit"),o=this.get(h),a=this.get(l),c=[];if(r){for(s._cancelPrintLoop(),e=i.length-1;0<=e&&0<=n;--e)o[(t=i[e]).category]&&a[t.source]&&(c.unshift(t),--n);r.setHTML(""),s.buffer=c,s.printBuffer()}},_uiSetCheckbox:function(e,t,i){var s,r,n;e&&t&&(s=e===h?this._categories:this._sources,r="input[type=checkbox]."+o(a,c,t),(n=s.one(r))||(e=this.get(g),this._createCheckbox(s,t),n=s.one(r),e._uiSetHeight(e.get("height"))),n.set(_,i))},_onCategoryCheckboxClick:function(e){var t,e=e.target;e.hasClass(n.CHROME_CLASSES.filter)&&(t=e.get("value"))&&t in this.get(h)&&this.set(u+t,e.get(_),{fromUI:!0})},_onSourceCheckboxClick:function(e){var t,e=e.target;e.hasClass(n.CHROME_CLASSES.filter)&&(t=e.get("value"))&&t in this.get(l)&&this.set(f+t,e.get(_),{fromUI:!0})},hideCategory:function(e,t){r(t)?i.Array.each(arguments,this.hideCategory,this):this.set(u+e,!1)},showCategory:function(e,t){r(t)?i.Array.each(arguments,this.showCategory,this):this.set(u+e,!0)},hideSource:function(e,t){r(t)?i.Array.each(arguments,this.hideSource,this):this.set(f+e,!1)},showSource:function(e,t){r(t)?i.Array.each(arguments,this.showSource,this):this.set(f+e,!0)},_createCheckbox:function(e,t){t=i.merge(n.CHROME_CLASSES,{filter_name:t,filter_class:o(a,c,t)}),t=i.Node.create(i.Lang.sub(n.FILTER_TEMPLATE,t));e.appendChild(t)},_validateCategory:function(e,t){return i.Lang.isObject(t,!0)&&e.split(/\./).length<3},_validateSource:function(e,t){return i.Lang.isObject(t,!0)&&e.split(/\./).length<3},_setCacheLimit:function(e){return i.Lang.isNumber(e)?this._cacheLimit=e:i.Attribute.INVALID_VALUE}},{NAME:"consoleFilters",NS:c,CATEGORIES_TEMPLATE:'<div class="{categories}"></div>',SOURCES_TEMPLATE:'<div class="{sources}"></div>',FILTER_TEMPLATE:'<label class="{filter_label}"><input type="checkbox" value="{filter_name}" class="{filter} {filter_class}"> {filter_name}</label>&#8201;',CHROME_CLASSES:{categories:o(a,t,"categories"),sources:o(a,t,"sources"),category:o(a,c,h),source:o(a,c,l),filter:o(a,c),filter_label:o(a,c,"label")},ATTRS:{defaultVisibility:{value:!0,validator:i.Lang.isBoolean},category:{value:{},validator:function(e,t){return this._validateCategory(t,e)}},source:{value:{},validator:function(e,t){return this._validateSource(t,e)}},cacheLimit:{value:Number.POSITIVE_INFINITY,setter:function(e){return this._setCacheLimit(e)}}}})},"@VERSION@",{requires:["plugin","console"],skinnable:!0});