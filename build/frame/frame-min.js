YUI.add("frame",function(r,e){var t=r.Lang,i="contentready",c="host",a=function(){a.superclass.constructor.apply(this,arguments)};r.extend(a,r.Plugin.Base,{_ready:null,_rendered:null,_iframe:null,_instance:null,_create:function(e){var t,n,i="",s=this.get("src")===a.ATTRS.src.value,o=this.get("extracss")?'<style id="extra_css">'+this.get("extracss")+"</style>":"";this._iframe=r.one(r.config.doc.createElement("iframe")),this._iframe.setAttrs(a.IFRAME_ATTRS),this._iframe.setStyle("visibility","hidden"),this._iframe.set("src",this.get("src")),this.get("container").append(this._iframe),this._iframe.set("height","99%"),s&&(i=r.Lang.sub(a.PAGE_HTML,{DIR:this.get("dir"),LANG:this.get("lang"),TITLE:this.get("title"),META:a.META,LINKED_CSS:this.get("linkedcss"),CONTENT:this.get("content"),BASE_HREF:this.get("basehref"),DEFAULT_CSS:a.DEFAULT_CSS,EXTRA_CSS:o}),"BackCompat"!==r.config.doc.compatMode)&&(i=a.getDocType()+"\n"+i),t=this._resolveWinDoc(),i&&(t.doc.open(),t.doc.write(i),t.doc.close()),t.doc.documentElement?e(t):n=r.later(1,this,function(){t.doc&&t.doc.documentElement&&(e(t),n.cancel())},null,!0)},_resolveWinDoc:function(e){e=e||{};return e.win=r.Node.getDOMNode(this._iframe.get("contentWindow")),e.doc=r.Node.getDOMNode(this._iframe.get("contentWindow.document")),e.doc||(e.doc=r.config.doc),e.win||(e.win=r.config.win),e},_onDomEvent:function(e){var t,n;r.Node.getDOMNode(this._iframe)&&(((e.frameX=e.frameY=0)<e.pageX||0<e.pageY)&&"key"!==e.type.substring(0,3)&&(n=this._instance.one("win"),t=this._iframe.getXY(),e.frameX=t[0]+e.pageX-n.get("scrollLeft"),e.frameY=t[1]+e.pageY-n.get("scrollTop")),e.frameTarget=e.target,e.frameCurrentTarget=e.currentTarget,e.frameEvent=e,this.fire("dom:"+e.type,e))},initializer:function(){var e=this.get(c);e&&(e.frame=this),this.publish("ready",{emitFacade:!0,defaultFn:this._defReadyFn})},destructor:function(){this.getInstance().one("doc").detachAll(),this._iframe.remove()},_DOMPaste:function(e){var t=this.getInstance(),n="",t=t.config.win;e._event.originalTarget&&(n=e._event.originalTarget),e._event.clipboardData&&(n=e._event.clipboardData.getData("Text")),t.clipboardData&&""===(n=t.clipboardData.getData("Text"))&&!t.clipboardData.setData("Text",n)&&(n=null),e.frameTarget=e.target,e.frameCurrentTarget=e.currentTarget,(e.frameEvent=e).clipboardData=n?{data:n,getData:function(){return n}}:null,this.fire("dom:paste",e)},_defReadyFn:function(){var s=this.getInstance();r.each(a.DOM_EVENTS,function(e,t){var n=r.bind(this._onDomEvent,this),i=r.UA.ie&&0<a.THROTTLE_TIME?r.throttle(n,a.THROTTLE_TIME):n;s.Node.DOM_EVENTS[t]||(s.Node.DOM_EVENTS[t]=1),1===e&&"focus"!==t&&"blur"!==t&&"paste"!==t&&("key"===t.substring(0,3)?s.on(t,i,s.config.doc):s.on(t,n,s.config.doc))},this),s.Node.DOM_EVENTS.paste=1,s.on("paste",r.bind(this._DOMPaste,this),s.one("body")),s.on("focus",r.bind(this._onDomEvent,this),s.config.win),s.on("blur",r.bind(this._onDomEvent,this),s.config.win),s.__use=s.use,s.use=r.bind(this.use,this),this._iframe.setStyles({visibility:"inherit"}),s.one("body").setStyle("display","block")},_fixIECursors:function(){var s,o=this.getInstance(),e=o.all("table"),t=o.all("br");e.size()&&t.size()&&(s=e.item(0).get("sourceIndex"),t.each(function(e){var t=e.get("parentNode"),n=t.get("children"),i=t.all(">br");t.test("div")&&(2<n.size()?e.replace(o.Node.create("<wbr>")):e.get("sourceIndex")>s?i.size()&&e.replace(o.Node.create("<wbr>")):1<i.size()&&e.replace(o.Node.create("<wbr>")))}))},_onContentReady:function(e){var t,n;this._ready||(this._ready=!0,t=this.getInstance(),n=r.clone(this.get("use")),this.fire("contentready"),e&&(t.config.doc=r.Node.getDOMNode(e.target)),n.push(r.bind(function(){t.EditorSelection&&(t.EditorSelection.DEFAULT_BLOCK_TAG=this.get("defaultblock")),this.get("designMode")&&(r.UA.ie?(t.config.doc.body.contentEditable="true",this._ieSetBodyHeight(),t.on("keyup",r.bind(this._ieSetBodyHeight,this),t.config.doc)):t.config.doc.designMode="on"),this.fire("ready")},this)),t.use.apply(t,n),t.one("doc").get("documentElement").addClass("yui-js-enabled"))},_ieHeightCounter:null,_ieSetBodyHeight:function(e){this._ieHeightCounter||(this._ieHeightCounter=0),this._ieHeightCounter++;var t,n,i=e?!1:!0;if(e){switch(e.keyCode){case 8:case 13:i=!0}(e.ctrlKey||e.shiftKey)&&(i=!0)}if(i)try{t=this.getInstance(),n=this._iframe.get("offsetHeight"),t.config.doc.body.scrollHeight<n?(n=n-15+"px",t.config.doc.body.style.height=n):t.config.doc.body.style.height="auto"}catch(e){this._ieHeightCounter<100&&r.later(200,this,this._ieSetBodyHeight)}},_resolveBaseHref:function(e){return e=e&&""!==e?e:(e=-1!==(e=r.config.doc.location.href).indexOf("?")?e.substring(0,e.indexOf("?")):e).substring(0,e.lastIndexOf("/"))+"/"},_getHTML:function(e){return e=this._ready?this.getInstance().one("body").get("innerHTML"):e},_setHTML:function(e){return this._ready?this.getInstance().one("body").set("innerHTML",e):this.once(i,r.bind(this._setHTML,this,e)),e},_getLinkedCSS:function(e){r.Lang.isArray(e)||(e=[e]);var t="";return this._ready?t=e:r.each(e,function(e){e&&(t+='<link rel="stylesheet" href="'+e+'" type="text/css">')}),t},_setLinkedCSS:function(e){return this._ready&&this.getInstance().Get.css(e),e},_setExtraCSS:function(e){var t,n;return this._ready?((n=(t=this.getInstance()).one("#extra_css"))&&n.remove(),t.one("head").append('<style id="extra_css">'+e+"</style>")):this.once(i,r.bind(this._setExtraCSS,this,e)),e},_instanceLoaded:function(e){this._instance=e,this._onContentReady();e=this._instance.config.doc;if(this.get("designMode")&&!r.UA.ie)try{e.execCommand("styleWithCSS",!1,!1),e.execCommand("insertbronreturn",!1,!1)}catch(t){}},use:function(){var e=this.getInstance(),t=r.Array(arguments),n=!1;return(n=r.Lang.isFunction(t[t.length-1])?t.pop():n)&&t.push(function(){n.apply(e,arguments)}),e.__use.apply(e,t)},delegate:function(e,t,n,i){var s=this.getInstance();return!!s&&(i||(i=n,n="body"),s.delegate(e,t,n,i))},getInstance:function(){return this._instance},render:function(e){
return this._rendered||(this._rendered=!0,e&&this.set("container",e),this._create(r.bind(function(e){var t,n,i=r.bind(function(e){this._instanceLoaded(e)},this),s=r.clone(this.get("use")),o={debug:!1,win:e.win,doc:e.doc},a=r.bind(function(){o=this._resolveWinDoc(o),(t=YUI(o)).host=this.get(c);try{t.use("node-base",i),n&&clearInterval(n)}catch(e){n=setInterval(function(){a()},350)}},this);s.push(a),r.use.apply(r,s)},this))),this},_handleFocus:function(){var e,t,n=this.getInstance(),i=new n.EditorSelection;i.anchorNode&&(e=(t=(t=i.anchorNode).test("p")&&""===t.get("innerHTML")?t.get("parentNode"):t).get("childNodes")).size()&&(e.item(0).test("br")?i.selectNode(t,!0,!1):e.item(0).test("p")?(t=(t=(t=(t=e.item(0).one("br.yui-cursor"))&&t.get("parentNode"))||e.item(0).get("firstChild"))||e.item(0))&&i.selectNode(t,!0,!1):(e=n.one("br.yui-cursor"))&&(t=e.get("parentNode"))&&i.selectNode(t,!0,!1))},_validateLinkedCSS:function(e){return t.isString(e)||t.isArray(e)},focus:function(e){if(r.UA.ie&&r.UA.ie<9){try{r.one("win").focus(),this.getInstance()&&this.getInstance().one("win")&&this.getInstance().one("win").focus()}catch(t){}!0===e&&this._handleFocus(),r.Lang.isFunction(e)&&e()}else try{r.one("win").focus(),r.later(100,this,function(){this.getInstance()&&this.getInstance().one("win")&&this.getInstance().one("win").focus(),!0===e&&this._handleFocus(),r.Lang.isFunction(e)&&e()})}catch(n){}return this},show:function(){if(this._iframe.setStyles({position:"static",left:""}),r.UA.gecko){try{this.getInstance()&&(this.getInstance().config.doc.designMode="on")}catch(e){}this.focus()}return this},hide:function(){return this._iframe.setStyles({position:"absolute",left:"-999999px"}),this}},{THROTTLE_TIME:100,DOM_EVENTS:{dblclick:1,click:1,paste:1,mouseup:1,mousedown:1,keyup:1,keydown:1,keypress:1,activate:1,deactivate:1,beforedeactivate:1,focusin:1,focusout:1},DEFAULT_CSS:"body { background-color: #fff; font: 13px/1.22 arial,helvetica,clean,sans-serif;*font-size:small;*font:x-small; } a, a:visited, a:hover { color: blue !important; text-decoration: underline !important; cursor: text !important; } img { cursor: pointer !important; border: none; }",IFRAME_ATTRS:{border:"0",frameBorder:"0",marginWidth:"0",marginHeight:"0",leftMargin:"0",topMargin:"0",allowTransparency:"true",width:"100%",height:"99%"},PAGE_HTML:'<html dir="{DIR}" lang="{LANG}"><head><title>{TITLE}</title>{META}<base href="{BASE_HREF}"/>{LINKED_CSS}<style id="editor_css">{DEFAULT_CSS}</style>{EXTRA_CSS}</head><body>{CONTENT}</body></html>',getDocType:function(){var e=r.config.doc.doctype,t=a.DOC_TYPE;return e?t="<!DOCTYPE "+e.name+(e.publicId?" "+e.publicId:"")+(e.systemId?" "+e.systemId:"")+">":r.config.doc.all&&(e=r.config.doc.all[0]).nodeType&&8===e.nodeType&&e.nodeValue&&-1!==e.nodeValue.toLowerCase().indexOf("doctype")&&(t="<!"+e.nodeValue+">"),t},DOC_TYPE:'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">',META:'<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta http-equiv="X-UA-Compatible" content="IE=7">',NAME:"frame",NS:"frame",ATTRS:{title:{value:"Blank Page"},dir:{value:"ltr"},lang:{value:"en-US"},src:{value:"javascript"+(r.UA.ie?":false":":")+";"},designMode:{writeOnce:!0,value:!1},content:{validator:t.isString,value:"<br>",setter:"_setHTML",getter:"_getHTML"},basehref:{value:!1,getter:"_resolveBaseHref"},use:{writeOnce:!0,value:["node","node-style","selector-css3"]},container:{value:"body",setter:function(e){return r.one(e)}},node:{readOnly:!0,value:null,getter:function(){return this._iframe}},id:{writeOnce:!0,getter:function(e){return e=e||"iframe-"+r.guid()}},linkedcss:{validator:"_validateLinkedCSS",getter:"_getLinkedCSS",setter:"_setLinkedCSS"},extracss:{validator:t.isString,setter:"_setExtraCSS"},defaultblock:{value:"p"}}}),r.namespace("Plugin"),r.Plugin.Frame=a,r.Frame=a},"@VERSION@",{requires:["base","node","plugin","selector-css3","yui-throttle"]});